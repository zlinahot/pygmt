


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>pygmt.gridops &mdash; PyGMT</title>
    


  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <!-- Google Analytics tracking code -->
    <!-- See https://developers.google.com/analytics/devguides/collection/analyticsjs/ for documentation. -->
    <!-- 'storage': 'none' disables cookies -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
            Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-38125837-7', 'auto', {'storage': 'none'});
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>

    <!-- Documentation switcher -->
    <!-- Point to the *dev* version switcher. This will allow the latest versions to appear on older documentation. -->
    <script type="text/javascript" src="/dev/_static/version_switch.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          
    <a href="../../index.html"><h2 class="sidebar-title">PyGMT</h2></a>

    
        
        
            <div class="version">
                dev
            </div>
        
    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/first-figure.html">Making your first figure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/frames.html">Frames, ticks, titles, and labels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projections/index.html">Projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/coastlines.html">Coastlines and borders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/plot.html">Plotting data points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/text.html">Plotting text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/contour-map.html">Creating a map with contour lines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/earth-relief.html">Plotting Earth relief</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/configuration.html">Configuring PyGMT defaults</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Getting help and contributing</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/LICENSE.txt"><i class="fa fa-book fa-fw"></i> License</a></li>
            
                <li class="toctree-l1"><a href="https://forum.generic-mapping-tools.org"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyGMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../pygmt.html">pygmt</a> &raquo;</li>
        
      <li>pygmt.gridops</li>
    
    
    <li class="source-link">
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pygmt.gridops</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">GMT modules for grid operations</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>


<span class="kn">from</span> <span class="nn">.clib</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">.helpers</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">build_arg_string</span><span class="p">,</span>
    <span class="n">fmt_docstring</span><span class="p">,</span>
    <span class="n">kwargs_to_strings</span><span class="p">,</span>
    <span class="n">GMTTempFile</span><span class="p">,</span>
    <span class="n">use_alias</span><span class="p">,</span>
    <span class="n">data_kind</span><span class="p">,</span>
    <span class="n">dummy_context</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="kn">import</span> <span class="n">GMTInvalidInput</span>


<div class="viewcode-block" id="grdcut"><a class="viewcode-back" href="../../api/generated/pygmt.grdcut.html#pygmt.grdcut">[docs]</a><span class="nd">@fmt_docstring</span>
<span class="nd">@use_alias</span><span class="p">(</span>
    <span class="n">G</span><span class="o">=</span><span class="s2">&quot;outgrid&quot;</span><span class="p">,</span>
    <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
    <span class="n">N</span><span class="o">=</span><span class="s2">&quot;extend&quot;</span><span class="p">,</span>
    <span class="n">S</span><span class="o">=</span><span class="s2">&quot;circ_subregion&quot;</span><span class="p">,</span>
    <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
    <span class="n">Z</span><span class="o">=</span><span class="s2">&quot;z_subregion&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">grdcut</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract subregion from a grid.</span>

<span class="sd">    Produce a new *outgrid* file which is a subregion of *grid*. The</span>
<span class="sd">    subregion is specified with *region*; the specified range must not exceed</span>
<span class="sd">    the range of *grid* (but see *extend*). If in doubt, run</span>
<span class="sd">    :meth:`pygmt.grdinfo` to check range. Alternatively, define the subregion</span>
<span class="sd">    indirectly via a range check on the node values or via distances from a</span>
<span class="sd">    given point. Finally, you can give *projection* for oblique projections to</span>
<span class="sd">    determine the corresponding rectangular *region* setting that will give a</span>
<span class="sd">    grid that fully covers the oblique domain.</span>

<span class="sd">    Full option list at :gmt-docs:`grdcut.html`</span>

<span class="sd">    {aliases}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grid : str or xarray.DataArray</span>
<span class="sd">        The file name of the input grid or the grid loaded as a DataArray.</span>
<span class="sd">    outgrid : str or None</span>
<span class="sd">        The name of the output netCDF file with extension .nc to store the grid</span>
<span class="sd">        in.</span>
<span class="sd">    {J}</span>
<span class="sd">    {R}</span>
<span class="sd">    extend : bool or int or float</span>
<span class="sd">        Allow grid to be extended if new *region* exceeds existing boundaries.</span>
<span class="sd">        Give a value to initialize nodes outside current region.</span>
<span class="sd">    circ_subregion : str</span>
<span class="sd">        ``&#39;lon/lat/radius[unit][+n]&#39;``.</span>
<span class="sd">        Specify an origin (*lon* and *lat*) and *radius*; append a distance</span>
<span class="sd">        *unit* and we determine the corresponding rectangular region so that</span>
<span class="sd">        all grid nodes on or inside the circle are contained in the subset.</span>
<span class="sd">        If **+n** is appended we set all nodes outside the circle to NaN.</span>
<span class="sd">    z_subregion : str</span>
<span class="sd">        ``&#39;[min/max][+n|N|r]&#39;``.</span>
<span class="sd">        Determine a new rectangular region so that all nodes outside this</span>
<span class="sd">        region are also outside the given z-range [-inf/+inf]. To indicate no</span>
<span class="sd">        limit on *min* or *max* only, specify a hyphen (-). Normally, any NaNs</span>
<span class="sd">        encountered are simply skipped and not considered in the</span>
<span class="sd">        range-decision. Append **+n** to consider a NaN to be outside the given</span>
<span class="sd">        z-range. This means the new subset will be NaN-free. Alternatively,</span>
<span class="sd">        append **+r** to consider NaNs to be within the data range. In this</span>
<span class="sd">        case we stop shrinking the boundaries once a NaN is found [Default</span>
<span class="sd">        simply skips NaNs when making the range decision]. Finally, if your</span>
<span class="sd">        core subset grid is surrounded by rows and/or columns that are all</span>
<span class="sd">        NaNs, append **+N** to strip off such columns before (optionally)</span>
<span class="sd">        considering the range of the core subset for further reduction of the</span>
<span class="sd">        area.</span>

<span class="sd">    {V}</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ret: xarray.DataArray or None</span>
<span class="sd">        Return type depends on whether the *outgrid* parameter is set:</span>

<span class="sd">        - xarray.DataArray if *outgrid* is not set</span>
<span class="sd">        - None if *outgrid* is set (grid output will be stored in *outgrid*)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">GMTTempFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmpfile</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;grid&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Unrecognized data type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">grid</span><span class="p">)))</span>

            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;G&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># if outgrid is unset, output to tempfile</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">})</span>
                <span class="n">outgrid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">infile</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;grdcut&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outgrid</span> <span class="o">==</span> <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>  <span class="c1"># if user did not set outgrid, return DataArray</span>
            <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataarray</span><span class="p">(</span><span class="n">outgrid</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataarray</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">dataarray</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">gmt</span>  <span class="c1"># load GMTDataArray accessor information</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># if user sets an outgrid, return None</span>

        <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="grdfilter"><a class="viewcode-back" href="../../api/generated/pygmt.grdfilter.html#pygmt.grdfilter">[docs]</a><span class="nd">@fmt_docstring</span>
<span class="nd">@use_alias</span><span class="p">(</span>
    <span class="n">D</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">,</span>
    <span class="n">F</span><span class="o">=</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span>
    <span class="n">G</span><span class="o">=</span><span class="s2">&quot;outgrid&quot;</span><span class="p">,</span>
    <span class="n">I</span><span class="o">=</span><span class="s2">&quot;spacing&quot;</span><span class="p">,</span>
    <span class="n">N</span><span class="o">=</span><span class="s2">&quot;nans&quot;</span><span class="p">,</span>
    <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">T</span><span class="o">=</span><span class="s2">&quot;toggle&quot;</span><span class="p">,</span>
    <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">grdfilter</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filter a grid in the space (or time) domain.</span>

<span class="sd">    Filter a grid file in the time domain using one of the selected convolution</span>
<span class="sd">    or non-convolution isotropic or rectangular filters and compute distances</span>
<span class="sd">    using Cartesian or Spherical geometries. The output grid file can</span>
<span class="sd">    optionally be generated as a sub-region of the input (via *region*) and/or</span>
<span class="sd">    with new increment (via *spacing*) or registration (via *toggle*). In this</span>
<span class="sd">    way, one may have &quot;extra space&quot; in the input data so that the edges will</span>
<span class="sd">    not be used and the output can be within one half-width of the input edges.</span>
<span class="sd">    If the filter is low-pass, then the output may be less frequently sampled</span>
<span class="sd">    than the input.</span>

<span class="sd">    Full option list at :gmt-docs:`grdfilter.html`</span>

<span class="sd">    {aliases}</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    grid : str or xarray.DataArray</span>
<span class="sd">        The file name of the input grid or the grid loaded as a DataArray.</span>
<span class="sd">    outgrid : str or None</span>
<span class="sd">        The name of the output netCDF file with extension .nc to store the grid</span>
<span class="sd">        in.</span>
<span class="sd">    filter : str</span>
<span class="sd">        ``xwidth[/width2][modifiers]``.</span>
<span class="sd">        Name of filter type you which to apply, followed by the width</span>
<span class="sd">        b: Box Car; c: Cosine Arch; g: Gaussian; o: Operator; m: Median;</span>
<span class="sd">        p: Maximum Likelihood probability; h: histogram</span>
<span class="sd">        Example: F=&#39;m600&#39; for a median filter with width of 600</span>
<span class="sd">    distance : str</span>
<span class="sd">        Distance *flag* tells how grid (x,y) relates to filter width as</span>
<span class="sd">        follows:</span>

<span class="sd">        p: grid (px,py) with *width* an odd number of pixels; Cartesian</span>
<span class="sd">        distances.</span>

<span class="sd">        0: grid (x,y) same units as *width*, Cartesian distances.</span>

<span class="sd">        1: grid (x,y) in degrees, *width* in kilometers, Cartesian distances.</span>

<span class="sd">        2: grid (x,y) in degrees, *width* in km, dx scaled by cos(middle y),</span>
<span class="sd">        Cartesian distances.</span>

<span class="sd">        The above options are fastest because they allow weight matrix to be</span>
<span class="sd">        computed only once. The next three options are slower because they</span>
<span class="sd">        recompute weights for each latitude.</span>

<span class="sd">        3: grid (x,y) in degrees, *width* in km, dx scaled by cosine(y),</span>
<span class="sd">        Cartesian distance calculation.</span>

<span class="sd">        4: grid (x,y) in degrees, *width* in km, Spherical distance</span>
<span class="sd">        calculation.</span>

<span class="sd">        5: grid (x,y) in Mercator ``projection=&#39;m1&#39;`` img units, *width* in km,</span>
<span class="sd">        Spherical distance calculation.</span>

<span class="sd">    spacing : str</span>
<span class="sd">        ``xinc[+e|n][/yinc[+e|n]]``.</span>
<span class="sd">        x_inc [and optionally y_inc] is the grid spacing.</span>
<span class="sd">    nans : str or float</span>
<span class="sd">        ``i|p|r``.</span>
<span class="sd">        Determine how NaN-values in the input grid affects the filtered output.</span>
<span class="sd">    {R}</span>
<span class="sd">    toggle : bool</span>
<span class="sd">        Toggle the node registration for the output grid so as to become the</span>
<span class="sd">        opposite of the input grid. [Default gives the same registration as the</span>
<span class="sd">        input grid].</span>
<span class="sd">    {V}</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ret: xarray.DataArray or None</span>
<span class="sd">        Return type depends on whether the *outgrid* parameter is set:</span>
<span class="sd">        - xarray.DataArray if *outgrid* is not set</span>
<span class="sd">        - None if *outgrid* is set (grid output will be stored in *outgrid*)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import os</span>
<span class="sd">    &gt;&gt;&gt; import pygmt</span>

<span class="sd">    &gt;&gt;&gt; # Apply a filter of 600km (full width) to the @earth_relief_30m file</span>
<span class="sd">    &gt;&gt;&gt; # and return a filtered field (saved as netcdf)</span>
<span class="sd">    &gt;&gt;&gt; pygmt.grdfilter(</span>
<span class="sd">    ...     grid=&quot;@earth_relief_30m&quot;,</span>
<span class="sd">    ...     filter=&quot;m600&quot;,</span>
<span class="sd">    ...     distance=&quot;4&quot;,</span>
<span class="sd">    ...     region=[150, 250, 10, 40],</span>
<span class="sd">    ...     spacing=0.5,</span>
<span class="sd">    ...     outgrid=&quot;filtered_pacific.nc&quot;,</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; os.remove(&quot;filtered_pacific.nc&quot;)  # cleanup file</span>

<span class="sd">    &gt;&gt;&gt; # Apply a gaussian smoothing filter of 600 km in the input data array,</span>
<span class="sd">    &gt;&gt;&gt; # and returns a filtered data array with the smoothed field.</span>
<span class="sd">    &gt;&gt;&gt; grid = pygmt.datasets.load_earth_relief()</span>
<span class="sd">    &gt;&gt;&gt; smooth_field = pygmt.grdfilter(grid=grid, filter=&quot;g600&quot;, distance=&quot;4&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">GMTTempFile</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.nc&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmpfile</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;grid&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Unrecognized data type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">grid</span><span class="p">)))</span>

            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;G&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># if outgrid is unset, output to tempfile</span>
                    <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">})</span>
                <span class="n">outgrid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">infile</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;grdfilter&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outgrid</span> <span class="o">==</span> <span class="n">tmpfile</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>  <span class="c1"># if user did not set outgrid, return DataArray</span>
            <span class="k">with</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataarray</span><span class="p">(</span><span class="n">outgrid</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataarray</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">dataarray</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
                <span class="n">_</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">gmt</span>  <span class="c1"># load GMTDataArray accessor information</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># if user sets an outgrid, return None</span>

        <span class="k">return</span> <span class="n">result</span></div>
</pre></div>

           </div>
           
          </div>
          
<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2020, The PyGMT Developers.
      
        <span class="commit">
          Revision <code><a href="https://github.com/GenericMappingTools/pygmt/commit/9aa3d36">9aa3d36</a></code>.
        </span>
      

    </p>
  </div>
<p>
Built with <a href="http://sphinx-doc.org/">Sphinx</a>
using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
provided by <a href="https://readthedocs.org">Read the Docs</a>
</p>
<p>
This website uses Google Analytics to gather usage statistics.
However, it does not use cookies or track you across different websites.
Page view data are used to help us improve the site and provide an estimate of the
software usage.
</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>