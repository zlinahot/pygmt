


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>pygmt.base_plotting &mdash; PyGMT</title>
    


  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <!-- Google Analytics tracking code -->
    <!-- See https://developers.google.com/analytics/devguides/collection/analyticsjs/ for documentation. -->
    <!-- 'storage': 'none' disables cookies -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
            Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-38125837-7', 'auto', {'storage': 'none'});
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>

    <!-- Documentation switcher -->
    <!-- Point to the *dev* version switcher. This will allow the latest versions to appear on older documentation. -->
    <script type="text/javascript" src="/dev/_static/version_switch.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          
    <a href="../../index.html"><h2 class="sidebar-title">PyGMT</h2></a>

    
        
        
            <div class="version">
                dev
            </div>
        
    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/first-figure.html">Making your first figure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/frames.html">Frames, ticks, titles, and labels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projections/index.html">Projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/coastlines.html">Coastlines and borders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/plot.html">Plotting data points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/text.html">Plotting text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/contour-map.html">Creating a map with contour lines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/earth-relief.html">Plotting Earth relief</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/configuration.html">Configuring PyGMT defaults</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Getting help and contributing</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt/blob/master/LICENSE.txt"><i class="fa fa-book fa-fw"></i> License</a></li>
            
                <li class="toctree-l1"><a href="https://forum.generic-mapping-tools.org"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/pygmt"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyGMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../pygmt.html">pygmt</a> &raquo;</li>
        
      <li>pygmt.base_plotting</li>
    
    
    <li class="source-link">
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pygmt.base_plotting</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Base class with plot generating commands.</span>
<span class="sd">Does not define any special non-GMT methods (savefig, show, etc).</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">contextlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">.clib</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="kn">from</span> <span class="nn">.exceptions</span> <span class="kn">import</span> <span class="n">GMTError</span><span class="p">,</span> <span class="n">GMTInvalidInput</span>
<span class="kn">from</span> <span class="nn">.helpers</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">build_arg_string</span><span class="p">,</span>
    <span class="n">dummy_context</span><span class="p">,</span>
    <span class="n">data_kind</span><span class="p">,</span>
    <span class="n">fmt_docstring</span><span class="p">,</span>
    <span class="n">use_alias</span><span class="p">,</span>
    <span class="n">kwargs_to_strings</span><span class="p">,</span>
    <span class="n">is_nonstr_iter</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">BasePlotting</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for Figure and Subplot.</span>

<span class="sd">    Defines the plot generating methods and a hook for subclasses to insert</span>
<span class="sd">    special arguments (the _preprocess method).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># pylint: disable=no-self-use</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make any changes to kwargs or required actions before plotting.</span>

<span class="sd">        This method is run before all plotting commands and can be used to</span>
<span class="sd">        insert special arguments into the kwargs or make any actions that are</span>
<span class="sd">        required before ``call_module``.</span>

<span class="sd">        For example, the :class:`pygmt.Figure` needs this to tell the GMT</span>
<span class="sd">        modules to plot to a specific figure.</span>

<span class="sd">        This is a dummy method that does nothing.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        kwargs : dict</span>
<span class="sd">            The same input kwargs dictionary.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; base = BasePlotting()</span>
<span class="sd">        &gt;&gt;&gt; base._preprocess(resolution=&quot;low&quot;)</span>
<span class="sd">        {&#39;resolution&#39;: &#39;low&#39;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">kwargs</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="s2">&quot;area_thresh&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;resolution&quot;</span><span class="p">,</span>
        <span class="n">I</span><span class="o">=</span><span class="s2">&quot;rivers&quot;</span><span class="p">,</span>
        <span class="n">L</span><span class="o">=</span><span class="s2">&quot;map_scale&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;borders&quot;</span><span class="p">,</span>
        <span class="n">W</span><span class="o">=</span><span class="s2">&quot;shorelines&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;land&quot;</span><span class="p">,</span>
        <span class="n">S</span><span class="o">=</span><span class="s2">&quot;water&quot;</span><span class="p">,</span>
        <span class="n">U</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">coast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot continents, shorelines, rivers, and borders on maps</span>

<span class="sd">        Plots grayshaded, colored, or textured land-masses [or water-masses] on</span>
<span class="sd">        maps and [optionally] draws coastlines, rivers, and political</span>
<span class="sd">        boundaries.  Alternatively, it can (1) issue clip paths that will</span>
<span class="sd">        contain all land or all water areas, or (2) dump the data to an ASCII</span>
<span class="sd">        table. The data files come in 5 different resolutions: (**f**)ull,</span>
<span class="sd">        (**h**)igh, (**i**)ntermediate, (**l**)ow, and (**c**)rude. The full</span>
<span class="sd">        resolution files amount to more than 55 Mb of data and provide great</span>
<span class="sd">        detail; for maps of larger geographical extent it is more economical to</span>
<span class="sd">        use one of the other resolutions. If the user selects to paint the</span>
<span class="sd">        land-areas and does not specify fill of water-areas then the latter</span>
<span class="sd">        will be transparent (i.e., earlier graphics drawn in those areas will</span>
<span class="sd">        not be overwritten).  Likewise, if the water-areas are painted and no</span>
<span class="sd">        land fill is set then the land-areas will be transparent.</span>

<span class="sd">        A map projection must be supplied.</span>

<span class="sd">        Full option list at :gmt-docs:`coast.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        area_thresh : int, float, or str</span>
<span class="sd">            ``&#39;min_area[/min_level/max_level][+ag|i|s|S][+r|l][+ppercent]&#39;``</span>
<span class="sd">            Features with an area smaller than min_area in km^2 or of</span>
<span class="sd">            hierarchical level that is lower than min_level or higher than</span>
<span class="sd">            max_level will not be plotted.</span>
<span class="sd">        {B}</span>
<span class="sd">        C : str</span>
<span class="sd">            Set the shade, color, or pattern for lakes and river-lakes.</span>
<span class="sd">        resolution : str</span>
<span class="sd">            Selects the resolution of the data set to use ((f)ull, (h)igh,</span>
<span class="sd">            (i)ntermediate, (l)ow, and (c)rude).</span>
<span class="sd">        land : str</span>
<span class="sd">            Select filling or clipping of “dry” areas.</span>
<span class="sd">        rivers : str</span>
<span class="sd">            ``&#39;river[/pen]&#39;``</span>
<span class="sd">            Draw rivers. Specify the type of rivers and [optionally] append pen</span>
<span class="sd">            attributes.</span>
<span class="sd">        map_scale : str</span>
<span class="sd">            ``&#39;[g|j|J|n|x]refpoint&#39;``</span>
<span class="sd">            Draws a simple map scale centered on the reference point specified.</span>
<span class="sd">        borders : str</span>
<span class="sd">            ``&#39;border[/pen]&#39;``</span>
<span class="sd">            Draw political boundaries. Specify the type of boundary and</span>
<span class="sd">            [optionally] append pen attributes</span>
<span class="sd">        water : str</span>
<span class="sd">            Select filling or clipping of “wet” areas.</span>
<span class="sd">        {U}</span>
<span class="sd">        {V}</span>
<span class="sd">        shorelines : str</span>
<span class="sd">            ``&#39;[level/]pen&#39;``</span>
<span class="sd">            Draw shorelines [Default is no shorelines]. Append pen attributes.</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;coast&quot;</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;position&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;truncate&quot;</span><span class="p">,</span>
        <span class="n">W</span><span class="o">=</span><span class="s2">&quot;scale&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a gray or color scale-bar on maps.</span>

<span class="sd">        Both horizontal and vertical scales are supported. For CPTs with</span>
<span class="sd">        gradational colors (i.e., the lower and upper boundary of an interval</span>
<span class="sd">        have different colors) we will interpolate to give a continuous scale.</span>
<span class="sd">        Variations in intensity due to shading/illumination may be displayed by</span>
<span class="sd">        setting the option -I. Colors may be spaced according to a linear</span>
<span class="sd">        scale, all be equal size, or by providing a file with individual tile</span>
<span class="sd">        widths.</span>

<span class="sd">        Full option list at :gmt-docs:`colorbar.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        frame : str or list</span>
<span class="sd">            Set color bar boundary frame, labels, and axes attributes.</span>
<span class="sd">        {CPT}</span>
<span class="sd">        position : str</span>
<span class="sd">            ``[g|j|J|n|x]refpoint[+wlength[/width]][+e[b|f][length]][+h|v]</span>
<span class="sd">            [+jjustify][+m[a|c|l|u]][+n[txt]][+odx[/dy]]``. Defines the</span>
<span class="sd">            reference point on the map for the color scale using one of four</span>
<span class="sd">            coordinate systems: (1) Use *g* for map (user) coordinates, (2) use</span>
<span class="sd">            *j* or *J* for setting refpoint via a 2-char justification code</span>
<span class="sd">            that refers to the (invisible) map domain rectangle, (3) use *n*</span>
<span class="sd">            for normalized (0-1) coordinates, or (4) use *x* for plot</span>
<span class="sd">            coordinates (inches, cm, etc.). All but *x* requires both *region*</span>
<span class="sd">            and *projection* to be specified. Append +w followed by the length</span>
<span class="sd">            and width of the color bar. If width is not specified then it is</span>
<span class="sd">            set to 4% of the given length. Give a negative length to reverse</span>
<span class="sd">            the scale bar. Append +h to get a horizontal scale</span>
<span class="sd">            [Default is vertical (+v)]. By default, the anchor point on the</span>
<span class="sd">            scale is assumed to be the bottom left corner (BL), but this can be</span>
<span class="sd">            changed by appending +j followed by a 2-char justification code</span>
<span class="sd">            *justify*.</span>
<span class="sd">        box : bool or str</span>
<span class="sd">            ``[+cclearances][+gfill][+i[[gap/]pen]][+p[pen]][+r[radius]]</span>
<span class="sd">            [+s[[dx/dy/][shade]]]``. If set to True, draws a rectangular</span>
<span class="sd">            border around the color scale. Alternatively, specify a different</span>
<span class="sd">            pen with +ppen. Add +gfill to fill the scale panel [no fill].</span>
<span class="sd">            Append +cclearance where clearance is either gap, xgap/ygap, or</span>
<span class="sd">            lgap/rgap/bgap/tgap where these items are uniform, separate in x-</span>
<span class="sd">            and y-direction, or individual side spacings between scale and</span>
<span class="sd">            border. Append +i to draw a secondary, inner border as well. We use</span>
<span class="sd">            a uniform gap between borders of 2p and the MAP_DEFAULTS_PEN unless</span>
<span class="sd">            other values are specified. Append +r to draw rounded rectangular</span>
<span class="sd">            borders instead, with a 6p corner radius. You can override this</span>
<span class="sd">            radius by appending another value. Finally, append +s to draw an</span>
<span class="sd">            offset background shaded region. Here, dx/dy indicates the shift</span>
<span class="sd">            relative to the foreground frame [4p/-4p] and shade sets the fill</span>
<span class="sd">            style to use for shading [gray50].</span>
<span class="sd">        truncate : list or str</span>
<span class="sd">            ``zlo/zhi`` Truncate the incoming CPT so that the lowest and</span>
<span class="sd">            highest z-levels are to zlo and zhi. If one of these equal NaN then</span>
<span class="sd">            we leave that end of the CPT alone. The truncation takes place</span>
<span class="sd">            before the plotting.</span>
<span class="sd">        scale : float</span>
<span class="sd">            Multiply all z-values in the CPT by the provided scale. By default</span>
<span class="sd">            the CPT is used as is.</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;colorbar&quot;</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">A</span><span class="o">=</span><span class="s2">&quot;annotation&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;interval&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;label_placement&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">L</span><span class="o">=</span><span class="s2">&quot;limit&quot;</span><span class="p">,</span>
        <span class="n">Q</span><span class="o">=</span><span class="s2">&quot;cut&quot;</span><span class="p">,</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">S</span><span class="o">=</span><span class="s2">&quot;resample&quot;</span><span class="p">,</span>
        <span class="n">U</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">W</span><span class="o">=</span><span class="s2">&quot;pen&quot;</span><span class="p">,</span>
        <span class="n">l</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="s2">&quot;sequence_plus&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">grdcontour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert grids or images to contours and plot them on maps</span>

<span class="sd">        Takes a grid file name or an xarray.DataArray object as input.</span>

<span class="sd">        Full option list at :gmt-docs:`grdcontour.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        grid : str or xarray.DataArray</span>
<span class="sd">            The file name of the input grid or the grid loaded as a DataArray.</span>
<span class="sd">        interval : str or int</span>
<span class="sd">            Specify the contour lines to generate.</span>

<span class="sd">            - The filename of a `CPT`  file where the color boundaries will</span>
<span class="sd">              be used as contour levels.</span>
<span class="sd">            - The filename of a 2 (or 3) column file containing the contour</span>
<span class="sd">              levels (col 1), (C)ontour or (A)nnotate (col 2), and optional</span>
<span class="sd">              angle (col 3)</span>
<span class="sd">            - A fixed contour interval ``cont_int`` or a single contour with</span>
<span class="sd">              ``+[cont_int]``</span>
<span class="sd">        annotation : str,  int, or list</span>
<span class="sd">            Specify or disable annotated contour levels, modifies annotated</span>
<span class="sd">            contours specified in ``-C``.</span>

<span class="sd">            - Specify a fixed annotation interval ``annot_int`` or a</span>
<span class="sd">              single annotation level ``+[annot_int]``</span>
<span class="sd">            - Disable all annotation  with  ``&#39;-&#39;``</span>
<span class="sd">            - Optional label modifiers can be specified as a single string</span>
<span class="sd">              ``&#39;[annot_int]+e&#39;``  or with a list of options</span>
<span class="sd">              ``([annot_int], &#39;e&#39;, &#39;f10p&#39;, &#39;gred&#39;)``.</span>
<span class="sd">        limit : str or list of 2 ints</span>
<span class="sd">            Do no draw contours below `low` or above `high`, specify as string</span>
<span class="sd">            ``&#39;[low]/[high]&#39;``  or list ``[low,high]``.</span>
<span class="sd">        cut : str or int</span>
<span class="sd">            Do not draw contours with less than `cut` number of points.</span>
<span class="sd">        resample : str or int</span>
<span class="sd">            Resample smoothing factor.</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        {B}</span>
<span class="sd">        label_placement : str</span>
<span class="sd">            ``[d|f|n|l|L|x|X]params``.</span>
<span class="sd">            The required argument controls the placement of labels along the</span>
<span class="sd">            quoted lines. It supports five controlling algorithms. See</span>
<span class="sd">            :gmt-docs:`grdcontour.html#g` for details.</span>
<span class="sd">        {U}</span>
<span class="sd">        {V}</span>
<span class="sd">        {W}</span>
<span class="sd">        {XY}</span>
<span class="sd">        label : str</span>
<span class="sd">            Add a legend entry for the contour being plotted. Normally, the</span>
<span class="sd">            annotated contour is selected for the legend. You can select the</span>
<span class="sd">            regular contour instead, or both of them, by considering the label</span>
<span class="sd">            to be of the format [*annotcontlabel*][/*contlabel*]. If either</span>
<span class="sd">            label contains a slash (/) character then use ``|`` as the</span>
<span class="sd">            separator for the two labels instead.</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;grid&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Unrecognized data type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">grid</span><span class="p">)))</span>
            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;grdcontour&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">A</span><span class="o">=</span><span class="s2">&quot;img_out&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;img_in&quot;</span><span class="p">,</span>
        <span class="n">E</span><span class="o">=</span><span class="s2">&quot;dpi&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;bit_color&quot;</span><span class="p">,</span>
        <span class="n">I</span><span class="o">=</span><span class="s2">&quot;shading&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">M</span><span class="o">=</span><span class="s2">&quot;monochrome&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;no_clip&quot;</span><span class="p">,</span>
        <span class="n">Q</span><span class="o">=</span><span class="s2">&quot;nan_transparent&quot;</span><span class="p">,</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">U</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="s2">&quot;interpolation&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;cores&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">grdimage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Project and plot grids or images.</span>

<span class="sd">        Reads a 2-D grid file and produces a gray-shaded (or colored) map by</span>
<span class="sd">        building a rectangular image and assigning pixels a gray-shade (or</span>
<span class="sd">        color) based on the z-value and the CPT file. Optionally, illumination</span>
<span class="sd">        may be added by providing a file with intensities in the (-1,+1) range</span>
<span class="sd">        or instructions to derive intensities from the input data grid. Values</span>
<span class="sd">        outside this range will be clipped. Such intensity files can be created</span>
<span class="sd">        from the grid using `grdgradient` and, optionally, modified by</span>
<span class="sd">        `grdmath` or `grdhisteq`. If GMT is built with GDAL support, *grid* can</span>
<span class="sd">        be an image file (geo-referenced or not). In this case the image can</span>
<span class="sd">        optionally be illuminated with the file provided via the *shading*</span>
<span class="sd">        option. Here, if image has no coordinates then those of the intensity</span>
<span class="sd">        file will be used.</span>

<span class="sd">        When using map projections, the grid is first resampled on a new</span>
<span class="sd">        rectangular grid with the same dimensions. Higher resolution images can</span>
<span class="sd">        be obtained by using the *dpi* option. To obtain the resampled value</span>
<span class="sd">        (and hence shade or color) of each map pixel, its location is inversely</span>
<span class="sd">        projected back onto the input grid after which a value is interpolated</span>
<span class="sd">        between the surrounding input grid values. By default bi-cubic</span>
<span class="sd">        interpolation is used. Aliasing is avoided by also forward projecting</span>
<span class="sd">        the input grid nodes. If two or more nodes are projected onto the same</span>
<span class="sd">        pixel, their average will dominate in the calculation of the pixel</span>
<span class="sd">        value. Interpolation and aliasing is controlled with the</span>
<span class="sd">        *interpolation* option.</span>

<span class="sd">        The *region* option can be used to select a map region larger or</span>
<span class="sd">        smaller than that implied by the extent of the grid.</span>

<span class="sd">        Full option list at :gmt-docs:`grdimage.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        grid : str or xarray.DataArray</span>
<span class="sd">            The file name or a DataArray containing the input 2-D gridded data</span>
<span class="sd">            set or image to be plotted (See GRID FILE FORMATS at</span>
<span class="sd">            :gmt-docs:`grdimage.html#grid-file-formats`).</span>
<span class="sd">        img_out : str</span>
<span class="sd">            ``out_img[=driver]``.</span>
<span class="sd">            Save an image in a raster format instead of PostScript. Use</span>
<span class="sd">            extension .ppm for a Portable Pixel Map format which is the only</span>
<span class="sd">            raster format GMT can natively write. For GMT installations</span>
<span class="sd">            configured with GDAL support there are more choices: Append</span>
<span class="sd">            *out_img* to select the image file name and extension. If the</span>
<span class="sd">            extension is one of .bmp, .gif, .jpg, .png, or .tif then no driver</span>
<span class="sd">            information is required. For other output formats you must append</span>
<span class="sd">            the required GDAL driver. The *driver* is the driver code name used</span>
<span class="sd">            by GDAL; see your GDAL installation&#39;s documentation for available</span>
<span class="sd">            drivers. Append a **+c**\\ *options* string where options is a list</span>
<span class="sd">            of one or more concatenated number of GDAL **-co** options. For</span>
<span class="sd">            example, to write a GeoPDF with the TerraGo format use</span>
<span class="sd">            ``=PDF+cGEO_ENCODING=OGC_BP``. Notes: (1) If a tiff file (.tif) is</span>
<span class="sd">            selected then we will write a GeoTiff image if the GMT projection</span>
<span class="sd">            syntax translates into a PROJ syntax, otherwise a plain tiff file</span>
<span class="sd">            is produced. (2) Any vector elements will be lost.</span>
<span class="sd">        {B}</span>
<span class="sd">        {CPT}</span>
<span class="sd">        img_in : str</span>
<span class="sd">            ``[r]``</span>
<span class="sd">            GMT will automatically detect standard image files (Geotiff, TIFF,</span>
<span class="sd">            JPG, PNG, GIF, etc.) and will read those via GDAL. For very obscure</span>
<span class="sd">            image formats you may need to explicitly set *img_in*, which</span>
<span class="sd">            specifies that the grid is in fact an image file to be read via</span>
<span class="sd">            GDAL. Append **r** to assign the region specified by *region*</span>
<span class="sd">            to the image. For example, if you have used ``region=&#39;d&#39;`` then the</span>
<span class="sd">            image will be assigned a global domain. This mode allows you to</span>
<span class="sd">            project a raw image (an image without referencing coordinates).</span>
<span class="sd">        dpi : int</span>
<span class="sd">            ``[i|dpi]``.</span>
<span class="sd">            Sets the resolution of the projected grid that will be created if a</span>
<span class="sd">            map projection other than Linear or Mercator was selected [100]. By</span>
<span class="sd">            default, the projected grid will be of the same size (rows and</span>
<span class="sd">            columns) as the input file. Specify **i** to use the PostScript</span>
<span class="sd">            image operator to interpolate the image at the device resolution.</span>
<span class="sd">        bit_color : str</span>
<span class="sd">            ``color[+b|f]``.</span>
<span class="sd">            This option only applies when a resulting 1-bit image otherwise</span>
<span class="sd">            would consist of only two colors: black (0) and white (255). If so,</span>
<span class="sd">            this option will instead use the image as a transparent mask and</span>
<span class="sd">            paint the mask with the given color. Append **+b** to paint the</span>
<span class="sd">            background pixels (1) or **+f** for the foreground pixels</span>
<span class="sd">            [Default].</span>
<span class="sd">        shading : str</span>
<span class="sd">            ``[intensfile|intensity|modifiers]``.</span>
<span class="sd">            Give the name of a grid file with intensities in the (-1,+1) range,</span>
<span class="sd">            or a constant intensity to apply everywhere (affects the ambient</span>
<span class="sd">            light). Alternatively, derive an intensity grid from the input data</span>
<span class="sd">            grid via a call to `grdgradient`; append **+a**\\ *azimuth*,</span>
<span class="sd">            **+n**\\ *args*, and **+m**\\ *ambient* to specify azimuth,</span>
<span class="sd">            intensity, and ambient arguments for that module, or just give</span>
<span class="sd">            **+d** to select the default arguments (``+a-45+nt1+m0``). If you</span>
<span class="sd">            want a more specific intensity scenario then run `grdgradient`</span>
<span class="sd">            separately first. If we should derive intensities from another file</span>
<span class="sd">            than grid, specify the file with suitable modifiers [Default is no</span>
<span class="sd">            illumination].</span>
<span class="sd">        {J}</span>
<span class="sd">        monochrome : bool</span>
<span class="sd">            Force conversion to monochrome image using the (television) YIQ</span>
<span class="sd">            transformation. Cannot be used with *nan_transparent*.</span>
<span class="sd">        no_clip : bool</span>
<span class="sd">            Do not clip the image at the map boundary (only relevant for</span>
<span class="sd">            non-rectangular maps).</span>
<span class="sd">        nan_transparent : bool</span>
<span class="sd">            Make grid nodes with z = NaN transparent, using the color-masking</span>
<span class="sd">            feature in PostScript Level 3 (the PS device must support PS Level</span>
<span class="sd">            3).</span>
<span class="sd">        {R}</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {n}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">        {x}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;grid&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Unrecognized data type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">grid</span><span class="p">)))</span>
            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;grdimage&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">Jz</span><span class="o">=</span><span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
        <span class="n">JZ</span><span class="o">=</span><span class="s2">&quot;zsize&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;drapegrid&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;plane&quot;</span><span class="p">,</span>
        <span class="n">Q</span><span class="o">=</span><span class="s2">&quot;surftype&quot;</span><span class="p">,</span>
        <span class="n">Wc</span><span class="o">=</span><span class="s2">&quot;contourpen&quot;</span><span class="p">,</span>
        <span class="n">Wm</span><span class="o">=</span><span class="s2">&quot;meshpen&quot;</span><span class="p">,</span>
        <span class="n">Wf</span><span class="o">=</span><span class="s2">&quot;facadepen&quot;</span><span class="p">,</span>
        <span class="n">I</span><span class="o">=</span><span class="s2">&quot;shading&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">grdview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create 3-D perspective image or surface mesh from a grid.</span>

<span class="sd">        Reads a 2-D grid file and produces a 3-D perspective plot by drawing a</span>
<span class="sd">        mesh, painting a colored/gray-shaded surface made up of polygons, or by</span>
<span class="sd">        scanline conversion of these polygons to a raster image. Options</span>
<span class="sd">        include draping a data set on top of a surface, plotting of contours on</span>
<span class="sd">        top of the surface, and apply artificial illumination based on</span>
<span class="sd">        intensities provided in a separate grid file.</span>

<span class="sd">        Full option list at :gmt-docs:`grdview.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        grid : str or xarray.DataArray</span>
<span class="sd">            The file name of the input relief grid or the grid loaded as a</span>
<span class="sd">            DataArray.</span>

<span class="sd">        zscale/zsize : float or str</span>
<span class="sd">            Set z-axis scaling or z-axis size.</span>

<span class="sd">        {B}</span>

<span class="sd">        cmap : str</span>
<span class="sd">            The name of the color palette table to use.</span>

<span class="sd">        drapegrid : str or xarray.DataArray</span>
<span class="sd">            The file name or a DataArray of the image grid to be draped on top</span>
<span class="sd">            of the relief provided by grid. [Default determines colors from</span>
<span class="sd">            grid]. Note that -Jz and -N always refers to the grid. The</span>
<span class="sd">            drapegrid only provides the information pertaining to colors, which</span>
<span class="sd">            (if drapegrid is a grid) will be looked-up via the CPT (see -C).</span>

<span class="sd">        plane : float or str</span>
<span class="sd">            ``level[+gfill]``.</span>
<span class="sd">            Draws a plane at this z-level. If the optional color is provided</span>
<span class="sd">            via the +g modifier, and the projection is not oblique, the frontal</span>
<span class="sd">            facade between the plane and the data perimeter is colored.</span>

<span class="sd">        surftype : str</span>
<span class="sd">            Specifies cover type of the grid.</span>
<span class="sd">            Select one of following settings:</span>
<span class="sd">            1. &#39;m&#39; for mesh plot [Default].</span>
<span class="sd">            2. &#39;mx&#39; or &#39;my&#39; for waterfall plots (row or column profiles).</span>
<span class="sd">            3. &#39;s&#39; for surface plot.</span>
<span class="sd">            4. &#39;i&#39; for image plot.</span>
<span class="sd">            5. &#39;c&#39;. Same as &#39;i&#39; but will make nodes with z = NaN transparent.</span>
<span class="sd">            For any of these choices, you may force a monochrome image by</span>
<span class="sd">            appending the modifier +m.</span>

<span class="sd">        contourpen : str</span>
<span class="sd">            Draw contour lines on top of surface or mesh (not image). Append</span>
<span class="sd">            pen attributes used for the contours.</span>
<span class="sd">        meshpen : str</span>
<span class="sd">            Sets the pen attributes used for the mesh. You must also select -Qm</span>
<span class="sd">            or -Qsm for meshlines to be drawn.</span>
<span class="sd">        facadepen :str</span>
<span class="sd">            Sets the pen attributes used for the facade. You must also select</span>
<span class="sd">            -N for the facade outline to be drawn.</span>

<span class="sd">        shading : str</span>
<span class="sd">            Provide the name of a grid file with intensities in the (-1,+1)</span>
<span class="sd">            range, or a constant intensity to apply everywhere (affects the</span>
<span class="sd">            ambient light). Alternatively, derive an intensity grid from the</span>
<span class="sd">            input data grid reliefgrid via a call to ``grdgradient``; append</span>
<span class="sd">            ``+aazimuth``, ``+nargs``, and ``+mambient`` to specify azimuth,</span>
<span class="sd">            intensity, and ambient arguments for that module, or just give</span>
<span class="sd">            ``+d`` to select the default arguments (``+a-45+nt1+m0``).</span>

<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;grid&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized data type for grid: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">ExitStack</span><span class="p">()</span> <span class="k">as</span> <span class="n">stack</span><span class="p">:</span>
                <span class="n">fname</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span><span class="n">file_context</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;G&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">drapegrid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">drapegrid</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;grid&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">drapegrid</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;grid&quot;</span><span class="p">:</span>
                            <span class="n">drape_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_grid</span><span class="p">(</span><span class="n">drapegrid</span><span class="p">)</span>
                            <span class="n">drapefile</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span><span class="n">drape_context</span><span class="p">)</span>
                            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">drapefile</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;Unrecognized data type for drapegrid: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">drapegrid</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;grdview&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">A</span><span class="o">=</span><span class="s2">&quot;straight_line&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span>
        <span class="n">E</span><span class="o">=</span><span class="s2">&quot;error_bar&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">=</span><span class="s2">&quot;connection&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="n">I</span><span class="o">=</span><span class="s2">&quot;intensity&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">L</span><span class="o">=</span><span class="s2">&quot;close&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;no_clip&quot;</span><span class="p">,</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">S</span><span class="o">=</span><span class="s2">&quot;style&quot;</span><span class="p">,</span>
        <span class="n">U</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">W</span><span class="o">=</span><span class="s2">&quot;pen&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">Z</span><span class="o">=</span><span class="s2">&quot;zvalue&quot;</span><span class="p">,</span>
        <span class="n">i</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span>
        <span class="n">l</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="s2">&quot;sequence_comma&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot lines, polygons, and symbols in 2-D.</span>

<span class="sd">        Takes a matrix, (x,y) pairs, or a file name as input and plots lines,</span>
<span class="sd">        polygons, or symbols at those locations on a map.</span>

<span class="sd">        Must provide either *data* or *x* and *y*.</span>

<span class="sd">        If providing data through *x* and *y*, *color* can be a 1d array that</span>
<span class="sd">        will be mapped to a colormap.</span>

<span class="sd">        If a symbol is selected and no symbol size given, then plot will</span>
<span class="sd">        interpret the third column of the input data as symbol size. Symbols</span>
<span class="sd">        whose size is &lt;= 0 are skipped. If no symbols are specified then the</span>
<span class="sd">        symbol code (see *style* below) must be present as last column in the</span>
<span class="sd">        input. If *style* is not used, a line connecting the data points will</span>
<span class="sd">        be drawn instead. To explicitly close polygons, use *close*. Select a</span>
<span class="sd">        fill with *color*. If *color* is set, *pen* will control whether the</span>
<span class="sd">        polygon outline is drawn or not. If a symbol is selected, *color* and</span>
<span class="sd">        *pen* determines the fill and outline/no outline, respectively.</span>

<span class="sd">        Full option list at :gmt-docs:`plot.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x/y : float or 1d arrays</span>
<span class="sd">            The x and y coordinates, or arrays of x and y coordinates of the</span>
<span class="sd">            data points</span>
<span class="sd">        data : str or 2d array</span>
<span class="sd">            Either a data file name or a 2d numpy array with the tabular data.</span>
<span class="sd">            Use option *columns* (i) to choose which columns are x, y, color,</span>
<span class="sd">            and size, respectively.</span>
<span class="sd">        sizes : 1d array</span>
<span class="sd">            The sizes of the data points in units specified in *style* (S).</span>
<span class="sd">            Only valid if using *x* and *y*.</span>
<span class="sd">        direction : list of two 1d arrays</span>
<span class="sd">            If plotting vectors (using ``style=&#39;V&#39;`` or ``style=&#39;v&#39;``), then</span>
<span class="sd">            should be a list of two 1d arrays with the vector directions. These</span>
<span class="sd">            can be angle and length, azimuth and length, or x and y components,</span>
<span class="sd">            depending on the style options chosen.</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        straight_line : bool or str</span>
<span class="sd">            ``[m|p|x|y]``.</span>
<span class="sd">            By default, geographic line segments are drawn as great circle</span>
<span class="sd">            arcs. To draw them as straight lines, use *straight_line*.</span>
<span class="sd">            Alternatively, add **m** to draw the line by first following a</span>
<span class="sd">            meridian, then a parallel. Or append **p** to start following a</span>
<span class="sd">            parallel, then a meridian. (This can be practical to draw a line</span>
<span class="sd">            along parallels, for example). For Cartesian data, points are</span>
<span class="sd">            simply connected, unless you append **x** or **y** to draw</span>
<span class="sd">            stair-case curves that whose first move is along *x* or *y*,</span>
<span class="sd">            respectively.</span>
<span class="sd">        {B}</span>
<span class="sd">        {CPT}</span>
<span class="sd">        offset : str</span>
<span class="sd">            ``dx/dy``.</span>
<span class="sd">            Offset the plot symbol or line locations by the given amounts</span>
<span class="sd">            *dx/dy* [Default is no offset]. If *dy* is not given it is set</span>
<span class="sd">            equal to *dx*.</span>
<span class="sd">        error_bar : bool or str</span>
<span class="sd">            ``[x|y|X|Y][+a][+cl|f][+n][+wcap][+ppen]``.</span>
<span class="sd">            Draw symmetrical error bars. Full documentation is at</span>
<span class="sd">            :gmt-docs:`plot.html#e`.</span>
<span class="sd">        connection : str</span>
<span class="sd">            ``[c|n|r][a|f|s|r|refpoint]``.</span>
<span class="sd">            Alter the way points are connected (by specifying a *scheme*) and</span>
<span class="sd">            data are grouped (by specifying a *method*). Append one of three</span>
<span class="sd">            line connection schemes:</span>

<span class="sd">            - **c** : Draw continuous line segments for each group [Default].</span>
<span class="sd">            - **r** : Draw line segments from a reference point reset for each</span>
<span class="sd">              group.</span>
<span class="sd">            - **n** : Draw networks of line segments between all points in</span>
<span class="sd">              each group.</span>

<span class="sd">            Optionally, append the one of four segmentation methods to define</span>
<span class="sd">            the group:</span>

<span class="sd">            - **a** : Ignore all segment headers, i.e., let all points belong</span>
<span class="sd">              to a single group, and set group reference point to the very</span>
<span class="sd">              first point of the first file.</span>
<span class="sd">            - **f** : Consider all data in each file to be a single separate</span>
<span class="sd">              group and reset the group reference point to the first point of</span>
<span class="sd">              each group.</span>
<span class="sd">            - **s** : Segment headers are honored so each segment is a group;</span>
<span class="sd">              the group reference point is reset to the first point of each</span>
<span class="sd">              incoming segment [Default].</span>
<span class="sd">            - **r** : Same as **s**, but the group reference point is reset</span>
<span class="sd">              after each record to the previous point (this method is only</span>
<span class="sd">              available with the ``connection=&#39;r&#39;`` scheme).</span>

<span class="sd">            Instead of the codes **a**|**f**|**s**|**r** you may append the</span>
<span class="sd">            coordinates of a *refpoint* which will serve as a fixed external</span>
<span class="sd">            reference point for all groups.</span>
<span class="sd">        {G}</span>
<span class="sd">        intensity : float or bool</span>
<span class="sd">            Provide an *intens* value (nominally in the -1 to +1 range) to</span>
<span class="sd">            modulate the fill color by simulating illumination [None]. If</span>
<span class="sd">            using ``intensity=True``, we will instead read *intens* from the</span>
<span class="sd">            first data column after the symbol parameters (if given).</span>
<span class="sd">        close : str</span>
<span class="sd">            ``[+b|d|D][+xl|r|x0][+yl|r|y0][+ppen]``.</span>
<span class="sd">            Force closed polygons. Full documentation is at</span>
<span class="sd">            :gmt-docs:`plot.html#l`.</span>
<span class="sd">        no_clip : bool or str</span>
<span class="sd">            ``&#39;[c|r]&#39;``.</span>
<span class="sd">            Do NOT clip symbols that fall outside map border [Default plots</span>
<span class="sd">            points whose coordinates are strictly inside the map border only].</span>
<span class="sd">            The option does not apply to lines and polygons which are always</span>
<span class="sd">            clipped to the map region. For periodic (360-longitude) maps we</span>
<span class="sd">            must plot all symbols twice in case they are clipped by the</span>
<span class="sd">            repeating boundary. ``no_clip=True`` will turn off clipping and not</span>
<span class="sd">            plot repeating symbols. Use ``no_clip=&quot;r&quot;`` to turn off clipping</span>
<span class="sd">            but retain the plotting of such repeating symbols, or use</span>
<span class="sd">            ``no_clip=&quot;c&quot;`` to retain clipping but turn off plotting of</span>
<span class="sd">            repeating symbols.</span>
<span class="sd">        style : str</span>
<span class="sd">            Plot symbols (including vectors, pie slices, fronts, decorated or</span>
<span class="sd">            quoted lines).</span>
<span class="sd">        {W}</span>
<span class="sd">        {U}</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        zvalue : str</span>
<span class="sd">            ``value|file``.</span>
<span class="sd">            Instead of specifying a symbol or polygon fill and outline color</span>
<span class="sd">            via **color** and **pen**, give both a *value* via **zvalue** and a</span>
<span class="sd">            color lookup table via **cmap**.  Alternatively, give the name of a</span>
<span class="sd">            *file* with one z-value (read from the last column) for each</span>
<span class="sd">            polygon in the input data. To apply it to the fill color, use</span>
<span class="sd">            ``color=&#39;+z&#39;``. To apply it to the pen color, append **+z** to</span>
<span class="sd">            **pen**.</span>
<span class="sd">        label : str</span>
<span class="sd">            Add a legend entry for the symbol or line being plotted.</span>

<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">            *transparency* can also be a 1d array to set varying transparency</span>
<span class="sd">            for symbols.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="n">extra_arrays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="s2">&quot;vV&quot;</span> <span class="ow">and</span> <span class="n">direction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;G&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">!=</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span>
                    <span class="s2">&quot;Can&#39;t use arrays for color if data is matrix or file.&quot;</span>
                <span class="p">)</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">])</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">!=</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span>
                    <span class="s2">&quot;Can&#39;t use arrays for sizes if data is matrix or file.&quot;</span>
                <span class="p">)</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;t&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">is_nonstr_iter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]):</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="c1"># Choose how data will be passed in to the module</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_vectors</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="o">*</span><span class="n">extra_arrays</span>
                <span class="p">)</span>

            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;plot&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">A</span><span class="o">=</span><span class="s2">&quot;straight_line&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;cmap&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="p">,</span>
        <span class="n">I</span><span class="o">=</span><span class="s2">&quot;intensity&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">Jz</span><span class="o">=</span><span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
        <span class="n">JZ</span><span class="o">=</span><span class="s2">&quot;zsize&quot;</span><span class="p">,</span>
        <span class="n">L</span><span class="o">=</span><span class="s2">&quot;close&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;no_clip&quot;</span><span class="p">,</span>
        <span class="n">Q</span><span class="o">=</span><span class="s2">&quot;no_sort&quot;</span><span class="p">,</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">S</span><span class="o">=</span><span class="s2">&quot;style&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">W</span><span class="o">=</span><span class="s2">&quot;pen&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">Z</span><span class="o">=</span><span class="s2">&quot;zvalue&quot;</span><span class="p">,</span>
        <span class="n">i</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span>
        <span class="n">l</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="s2">&quot;sequence_comma&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">plot3d</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sizes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot lines, polygons, and symbols in 3-D</span>

<span class="sd">        Takes a matrix, (x,y,z) triplets, or a file name as input and plots</span>
<span class="sd">        lines, polygons, or symbols at those locations in 3-D.</span>

<span class="sd">        Must provide either *data* or *x*, *y* and *z*.</span>

<span class="sd">        If providing data through *x*, *y* and *z*, *color* can be a 1d array</span>
<span class="sd">        that will be mapped to a colormap.</span>

<span class="sd">        If a symbol is selected and no symbol size given, then plot3d will</span>
<span class="sd">        interpret the fourth column of the input data as symbol size. Symbols</span>
<span class="sd">        whose size is &lt;= 0 are skipped. If no symbols are specified then the</span>
<span class="sd">        symbol code (see *style* below) must be present as last column in the</span>
<span class="sd">        input. If *style* is not used, a line connecting the data points will</span>
<span class="sd">        be drawn instead. To explicitly close polygons, use *close*. Select a</span>
<span class="sd">        fill with *color*. If *color* is set, *pen* will control whether the</span>
<span class="sd">        polygon outline is drawn or not. If a symbol is selected, *color* and</span>
<span class="sd">        *pen* determines the fill and outline/no outline, respectively.</span>

<span class="sd">        Full option list at :gmt-docs:`plot3d.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x/y/z : float or 1d arrays</span>
<span class="sd">            The x, y, and z coordinates, or arrays of x, y and z coordinates of</span>
<span class="sd">            the data points</span>
<span class="sd">        data : str or 2d array</span>
<span class="sd">            Either a data file name or a 2d numpy array with the tabular data.</span>
<span class="sd">            Use option *columns* (i) to choose which columns are x, y, z,</span>
<span class="sd">            color, and size, respectively.</span>
<span class="sd">        sizes : 1d array</span>
<span class="sd">            The sizes of the data points in units specified in *style* (S).</span>
<span class="sd">            Only valid if using *x*, *y* and *z*.</span>
<span class="sd">        direction : list of two 1d arrays</span>
<span class="sd">            If plotting vectors (using ``style=&#39;V&#39;`` or ``style=&#39;v&#39;``), then</span>
<span class="sd">            should be a list of two 1d arrays with the vector directions. These</span>
<span class="sd">            can be angle and length, azimuth and length, or x and y components,</span>
<span class="sd">            depending on the style options chosen.</span>
<span class="sd">        {J}</span>
<span class="sd">        zscale/zsize : float or str</span>
<span class="sd">            Set z-axis scaling or z-axis size.</span>
<span class="sd">        {R}</span>
<span class="sd">        straight_line : bool or str</span>
<span class="sd">            ``[m|p|x|y]``.</span>
<span class="sd">            By default, geographic line segments are drawn as great circle</span>
<span class="sd">            arcs. To draw them as straight lines, use *straight_line*.</span>
<span class="sd">            Alternatively, add **m** to draw the line by first following a</span>
<span class="sd">            meridian, then a parallel. Or append **p** to start following a</span>
<span class="sd">            parallel, then a meridian. (This can be practical to draw a line</span>
<span class="sd">            along parallels, for example). For Cartesian data, points are</span>
<span class="sd">            simply connected, unless you append **x** or **y** to draw</span>
<span class="sd">            stair-case curves that whose first move is along *x* or *y*,</span>
<span class="sd">            respectively. **Note**: The **straight_line** option requires</span>
<span class="sd">            constant *z*-coordinates.</span>
<span class="sd">        {B}</span>
<span class="sd">        {CPT}</span>
<span class="sd">        offset : str</span>
<span class="sd">            ``dx/dy[/dz]``.</span>
<span class="sd">            Offset the plot symbol or line locations by the given amounts</span>
<span class="sd">            *dx/dy*[*dz*] [Default is no offset].</span>
<span class="sd">        {G}</span>
<span class="sd">        intensity : float or bool</span>
<span class="sd">            Provide an *intens* value (nominally in the -1 to +1 range) to</span>
<span class="sd">            modulate the fill color by simulating illumination [None]. If</span>
<span class="sd">            using ``intensity=True``, we will instead read *intens* from the</span>
<span class="sd">            first data column after the symbol parameters (if given).</span>
<span class="sd">        close : str</span>
<span class="sd">            ``[+b|d|D][+xl|r|x0][+yl|r|y0][+ppen]``.</span>
<span class="sd">            Force closed polygons. Full documentation is at</span>
<span class="sd">            :gmt-docs:`plot3d.html#l`.</span>
<span class="sd">        no_clip : bool or str</span>
<span class="sd">            ``[c|r]``.</span>
<span class="sd">            Do NOT clip symbols that fall outside map border [Default plots</span>
<span class="sd">            points whose coordinates are strictly inside the map border only].</span>
<span class="sd">            The option does not apply to lines and polygons which are always</span>
<span class="sd">            clipped to the map region. For periodic (360-longitude) maps we</span>
<span class="sd">            must plot all symbols twice in case they are clipped by the</span>
<span class="sd">            repeating boundary. ``no_clip=True`` will turn off clipping and not</span>
<span class="sd">            plot repeating symbols. Use ``no_clip=&quot;r&quot;`` to turn off clipping</span>
<span class="sd">            but retain the plotting of such repeating symbols, or use</span>
<span class="sd">            ``no_clip=&quot;c&quot;`` to retain clipping but turn off plotting of</span>
<span class="sd">            repeating symbols.</span>
<span class="sd">        no_sort : bool</span>
<span class="sd">            Turn off the automatic sorting of items based on their distance</span>
<span class="sd">            from the viewer. The default is to sort the items so that items in</span>
<span class="sd">            the foreground are plotted after items in the background.</span>
<span class="sd">        style : str</span>
<span class="sd">            Plot symbols. Full documentation is at :gmt-docs:`plot3d.html#s`.</span>
<span class="sd">        {U}</span>
<span class="sd">        {V}</span>
<span class="sd">        {W}</span>
<span class="sd">        {XY}</span>
<span class="sd">        zvalue : str</span>
<span class="sd">            ``value|file``.</span>
<span class="sd">            Instead of specifying a symbol or polygon fill and outline color</span>
<span class="sd">            via **color** and **pen**, give both a *value* via **zvalue** and a</span>
<span class="sd">            color lookup table via **cmap**.  Alternatively, give the name of a</span>
<span class="sd">            *file* with one z-value (read from the last column) for each</span>
<span class="sd">            polygon in the input data. To apply it to the fill color, use</span>
<span class="sd">            ``color=&#39;+z&#39;``. To apply it to the pen color, append **+z** to</span>
<span class="sd">            **pen**.</span>
<span class="sd">        label : str</span>
<span class="sd">            Add a legend entry for the symbol or line being plotted.</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">            *transparency* can also be a 1d array to set varying transparency</span>
<span class="sd">            for symbols.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

        <span class="n">extra_arrays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">&quot;S&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="s2">&quot;vV&quot;</span> <span class="ow">and</span> <span class="n">direction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;G&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">!=</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span>
                    <span class="s2">&quot;Can&#39;t use arrays for color if data is matrix or file.&quot;</span>
                <span class="p">)</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">])</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sizes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">!=</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span>
                    <span class="s2">&quot;Can&#39;t use arrays for sizes if data is matrix or file.&quot;</span>
                <span class="p">)</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;t&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">is_nonstr_iter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]):</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="c1"># Choose how data will be passed in to the module</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_vectors</span><span class="p">(</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="o">*</span><span class="n">extra_arrays</span>
                <span class="p">)</span>

            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;plot3d&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">S</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;label_placement&quot;</span><span class="p">,</span>
        <span class="n">W</span><span class="o">=</span><span class="s2">&quot;pen&quot;</span><span class="p">,</span>
        <span class="n">L</span><span class="o">=</span><span class="s2">&quot;triangular_mesh_pen&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;no_clip&quot;</span><span class="p">,</span>
        <span class="n">i</span><span class="o">=</span><span class="s2">&quot;columns&quot;</span><span class="p">,</span>
        <span class="n">l</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;levels&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="s2">&quot;sequence_comma&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">contour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Contour table data by direct triangulation.</span>

<span class="sd">        Takes a matrix, (x,y,z) pairs, or a file name as input and plots lines,</span>
<span class="sd">        polygons, or symbols at those locations on a map.</span>

<span class="sd">        Must provide either *data* or *x*, *y*, and *z*.</span>

<span class="sd">        [TODO: Insert more documentation]</span>

<span class="sd">        Full option list at :gmt-docs:`contour.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x/y/z : 1d arrays</span>
<span class="sd">            Arrays of x and y coordinates and values z of the data points.</span>
<span class="sd">        data : str or 2d array</span>
<span class="sd">            Either a data file name or a 2d numpy array with the tabular data.</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        A : bool or str</span>
<span class="sd">            ``&#39;[m|p|x|y]&#39;``</span>
<span class="sd">            By default, geographic line segments are drawn as great circle</span>
<span class="sd">            arcs. To draw them as straight lines, use *A*.</span>
<span class="sd">        {B}</span>
<span class="sd">        levels : str</span>
<span class="sd">            Contour file or level(s)</span>
<span class="sd">        D : str</span>
<span class="sd">            Dump contour coordinates</span>
<span class="sd">        E : str</span>
<span class="sd">            Network information</span>
<span class="sd">        label_placement : str</span>
<span class="sd">            Placement of labels</span>
<span class="sd">        I : bool</span>
<span class="sd">            Color the triangles using CPT</span>
<span class="sd">        triangular_mesh_pen : str</span>
<span class="sd">            Pen to draw the underlying triangulation (default none)</span>
<span class="sd">        no_clip : bool</span>
<span class="sd">            Do NOT clip contours or image at the boundaries [Default will clip</span>
<span class="sd">            to fit inside region].</span>
<span class="sd">        Q : float or str</span>
<span class="sd">            Do not draw contours with less than cut number of points.</span>
<span class="sd">            ``&#39;[cut[unit]][+z]&#39;``</span>
<span class="sd">        skip : bool or str</span>
<span class="sd">            Skip input points outside region ``&#39;[p|t]&#39;``</span>
<span class="sd">        {W}</span>
<span class="sd">        label : str</span>
<span class="sd">            Add a legend entry for the contour being plotted. Normally, the</span>
<span class="sd">            annotated contour is selected for the legend. You can select the</span>
<span class="sd">            regular contour instead, or both of them, by considering the label</span>
<span class="sd">            to be of the format [*annotcontlabel*][/*contlabel*]. If either</span>
<span class="sd">            label contains a slash (/) character then use ``|`` as the</span>
<span class="sd">            separator for the two labels instead.</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;vectors&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Must provided both x, y, and z.&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="c1"># Choose how data will be passed in to the module</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_matrix</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;contour&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">Jz</span><span class="o">=</span><span class="s2">&quot;zscale&quot;</span><span class="p">,</span>
        <span class="n">JZ</span><span class="o">=</span><span class="s2">&quot;zsize&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">L</span><span class="o">=</span><span class="s2">&quot;map_scale&quot;</span><span class="p">,</span>
        <span class="n">Td</span><span class="o">=</span><span class="s2">&quot;rose&quot;</span><span class="p">,</span>
        <span class="n">Tm</span><span class="o">=</span><span class="s2">&quot;compass&quot;</span><span class="p">,</span>
        <span class="n">U</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">basemap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot base maps and frames for the figure.</span>

<span class="sd">        Creates a basic or fancy basemap with axes, fill, and titles. Several</span>
<span class="sd">        map projections are available, and the user may specify separate</span>
<span class="sd">        tick-mark intervals for boundary annotation, ticking, and [optionally]</span>
<span class="sd">        gridlines. A simple map scale or directional rose may also be plotted.</span>

<span class="sd">        At least one of the options *frame*, *map_scale*, *rose* or *compass*</span>
<span class="sd">        must be specified.</span>

<span class="sd">        Full option list at :gmt-docs:`basemap.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        {J}</span>
<span class="sd">        zscale/zsize : float or str</span>
<span class="sd">            Set z-axis scaling or z-axis size.</span>
<span class="sd">        {R}</span>
<span class="sd">        {B}</span>
<span class="sd">        map_scale : str</span>
<span class="sd">            ``&#39;[g|j|J|n|x]refpoint&#39;``</span>
<span class="sd">            Draws a simple map scale centered on the reference point specified.</span>
<span class="sd">        rose : str</span>
<span class="sd">            Draws a map directional rose on the map at the location defined by</span>
<span class="sd">            the reference and anchor points.</span>
<span class="sd">        compass : str</span>
<span class="sd">            Draws a map magnetic rose on the map at the location defined by the</span>
<span class="sd">            reference and anchor points</span>
<span class="sd">        {U}</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;B&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;L&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="s2">&quot;T&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;At least one of B, L, or T must be specified.&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;basemap&quot;</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;position&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">,</span>
        <span class="n">S</span><span class="o">=</span><span class="s2">&quot;style&quot;</span><span class="p">,</span>
        <span class="n">U</span><span class="o">=</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">logo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the GMT logo.</span>

<span class="sd">        By default, the GMT logo is 2 inches wide and 1 inch high and</span>
<span class="sd">        will be positioned relative to the current plot origin.</span>
<span class="sd">        Use various options to change this and to place a transparent or</span>
<span class="sd">        opaque rectangular map panel behind the GMT logo.</span>

<span class="sd">        Full option list at :gmt-docs:`gmtlogo.html`.</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        position : str</span>
<span class="sd">            ``&#39;[g|j|J|n|x]refpoint+wwidth[+jjustify][+odx[/dy]]&#39;``.</span>
<span class="sd">            Sets reference point on the map for the image.</span>
<span class="sd">        box : bool or str</span>
<span class="sd">            Without further options, draws a rectangular border around the</span>
<span class="sd">            GMT logo.</span>
<span class="sd">        style : str</span>
<span class="sd">            ``l|n|u``.</span>
<span class="sd">            Control what is written beneath the map portion of the logo.</span>

<span class="sd">            - **l** to plot the text label &quot;The Generic Mapping Tools&quot;</span>
<span class="sd">              [Default]</span>
<span class="sd">            - **n** to skip the label placement</span>
<span class="sd">            - **u** to place the URL to the GMT site</span>
<span class="sd">        {U}</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {t}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;logo&quot;</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;position&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">,</span>
        <span class="n">M</span><span class="o">=</span><span class="s2">&quot;monochrome&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imagefile</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Place images or EPS files on maps.</span>

<span class="sd">        Reads an Encapsulated PostScript file or a raster image file and plots</span>
<span class="sd">        it on a map.</span>

<span class="sd">        Full option list at :gmt-docs:`image.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        imagefile : str</span>
<span class="sd">            This must be an Encapsulated PostScript (EPS) file or a raster</span>
<span class="sd">            image. An EPS file must contain an appropriate BoundingBox. A</span>
<span class="sd">            raster file can have a depth of 1, 8, 24, or 32 bits and is read</span>
<span class="sd">            via GDAL. Note: If GDAL was not configured during GMT installation</span>
<span class="sd">            then only EPS files are supported.</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        position : str</span>
<span class="sd">            ``&#39;[g|j|J|n|x]refpoint+rdpi+w[-]width[/height][+jjustify]</span>
<span class="sd">            [+nnx[/ny]][+odx[/dy]]&#39;`` Sets reference point on the map for the</span>
<span class="sd">            image.</span>
<span class="sd">        box : bool or str</span>
<span class="sd">            ``&#39;[+cclearances][+gfill][+i[[gap/]pen]][+p[pen]][+r[radius]]</span>
<span class="sd">            [+s[[dx/dy/][shade]]]&#39;`` Without further options, draws a</span>
<span class="sd">            rectangular border around the image using **MAP_FRAME_PEN**.</span>
<span class="sd">        monochrome : bool</span>
<span class="sd">            Convert color image to monochrome grayshades using the (television)</span>
<span class="sd">            YIQ-transformation.</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">imagefile</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
            <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;position&quot;</span><span class="p">,</span>
        <span class="n">F</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">&quot;JTR+jTR+o0.2c&quot;</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="s2">&quot;+gwhite+p1p&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot legends on maps.</span>

<span class="sd">        Makes legends that can be overlaid on maps. Reads specific</span>
<span class="sd">        legend-related information from an input file, or automatically creates</span>
<span class="sd">        legend entries from plotted symbols that have labels. Unless otherwise</span>
<span class="sd">        noted, annotations will be made using the primary annotation font and</span>
<span class="sd">        size in effect (i.e., FONT_ANNOT_PRIMARY).</span>

<span class="sd">        Full option list at :gmt-docs:`legend.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        spec : None or str</span>
<span class="sd">            Either None (default) for using the automatically generated legend</span>
<span class="sd">            specification file, or a filename pointing to the legend</span>
<span class="sd">            specification file.</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        position : str</span>
<span class="sd">            ``&#39;[g|j|J|n|x]refpoint+wwidth[/height][+jjustify][+lspacing]</span>
<span class="sd">            [+odx[/dy]]&#39;`` Defines the reference point on the map for the</span>
<span class="sd">            legend. By default, uses &#39;JTR+jTR+o0.2c&#39; which places the legend at</span>
<span class="sd">            the top-right corner inside the map frame, with a 0.2 cm offset.</span>
<span class="sd">        box : bool or str</span>
<span class="sd">            ``&#39;[+cclearances][+gfill][+i[[gap/]pen]][+p[pen]][+r[radius]]</span>
<span class="sd">            [+s[[dx/dy/][shade]]]&#39;`` Without further options, draws a</span>
<span class="sd">            rectangular border around the legend using **MAP_FRAME_PEN**. By</span>
<span class="sd">            default, uses &#39;+gwhite+p1p&#39; which draws a box around the legend</span>
<span class="sd">            using a 1 point black pen and adds a white background.</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="s2">&quot;D&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">position</span>

            <span class="k">if</span> <span class="s2">&quot;F&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">box</span>

        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">specfile</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">elif</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">specfile</span> <span class="o">=</span> <span class="n">spec</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Unrecognized data type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="p">)))</span>
            <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">specfile</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
            <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;legend&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;clearance&quot;</span><span class="p">,</span>
        <span class="n">D</span><span class="o">=</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="s2">&quot;fill&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;no_clip&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">W</span><span class="o">=</span><span class="s2">&quot;pen&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span>
        <span class="n">textfiles</span><span class="o">=</span><span class="s2">&quot;sequence_space&quot;</span><span class="p">,</span>
        <span class="n">angle</span><span class="o">=</span><span class="s2">&quot;sequence_comma&quot;</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="s2">&quot;sequence_comma&quot;</span><span class="p">,</span>
        <span class="n">justify</span><span class="o">=</span><span class="s2">&quot;sequence_comma&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">textfiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">position</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">font</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">justify</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot or typeset text strings of variable size, font type, and</span>
<span class="sd">        orientation.</span>

<span class="sd">        Must provide at least one of the following combinations as input:</span>

<span class="sd">        - *textfiles*</span>
<span class="sd">        - *x*, *y*, and *text*</span>
<span class="sd">        - *position* and *text*</span>

<span class="sd">        Full option list at :gmt-docs:`text.html`</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        textfiles : str or list</span>
<span class="sd">            A text data file name, or a list of filenames containing 1 or more</span>
<span class="sd">            records with (x, y[, angle, font, justify], text).</span>
<span class="sd">        x/y : float or 1d arrays</span>
<span class="sd">            The x and y coordinates, or an array of x and y coordinates to plot</span>
<span class="sd">            the text</span>
<span class="sd">        position : str</span>
<span class="sd">            Sets reference point on the map for the text by using x,y</span>
<span class="sd">            coordinates extracted from *region* instead of providing them</span>
<span class="sd">            through *x* and *y*. Specify with a two letter (order independent)</span>
<span class="sd">            code, chosen from:</span>

<span class="sd">            * Horizontal: L(eft), C(entre), R(ight)</span>
<span class="sd">            * Vertical: T(op), M(iddle), B(ottom)</span>

<span class="sd">            For example, position=&quot;TL&quot; plots the text at the Upper Left corner</span>
<span class="sd">            of the map.</span>
<span class="sd">        text : str or 1d array</span>
<span class="sd">            The text string, or an array of strings to plot on the figure</span>
<span class="sd">        angle: int, float, str or bool</span>
<span class="sd">            Set the angle measured in degrees counter-clockwise from</span>
<span class="sd">            horizontal. E.g. 30 sets the text at 30 degrees. If no angle is</span>
<span class="sd">            explicitly given (i.e. angle=True) then the input textfile(s) must</span>
<span class="sd">            have this as a column.</span>
<span class="sd">        font : str or bool</span>
<span class="sd">            Set the font specification with format &quot;size,font,color&quot; where size</span>
<span class="sd">            is text size in points, font is the font to use, and color sets the</span>
<span class="sd">            font color. E.g. &quot;12p,Helvetica-Bold,red&quot; selects a 12p red</span>
<span class="sd">            Helvetica-Bold font. If no font info is explicitly given (i.e.</span>
<span class="sd">            font=True), then the input textfile(s) must have this information</span>
<span class="sd">            in one of its columns.</span>
<span class="sd">        justify : str or bool</span>
<span class="sd">            Set the alignment which refers to the part of the text string that</span>
<span class="sd">            will be mapped onto the (x,y) point. Choose a 2 character</span>
<span class="sd">            combination of L, C, R (for left, center, or right) and T, M, B for</span>
<span class="sd">            top, middle, or bottom. E.g., BL for lower left. If no</span>
<span class="sd">            justification is explicitly given (i.e. justify=True), then the</span>
<span class="sd">            input textfile(s) must have this as a column.</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        clearance : str</span>
<span class="sd">            ``[dx/dy][+to|O|c|C]``</span>
<span class="sd">            Adjust the clearance between the text and the surrounding box</span>
<span class="sd">            [15%]. Only used if *pen* or *fill* are specified. Append the unit</span>
<span class="sd">            you want (&#39;c&#39; for cm, &#39;i&#39; for inch, or &#39;p&#39; for point; if not given</span>
<span class="sd">            we consult &#39;PROJ_LENGTH_UNIT&#39;) or &#39;%&#39; for a percentage of the</span>
<span class="sd">            font size. Optionally, use modifier &#39;+t&#39; to set the shape of the</span>
<span class="sd">            textbox when using *fill* and/or *pen*. Append lower case &#39;o&#39; to</span>
<span class="sd">            get a straight rectangle [Default]. Append upper case &#39;O&#39; to get a</span>
<span class="sd">            rounded rectangle. In paragraph mode (*paragraph*) you can also</span>
<span class="sd">            append lower case &#39;c&#39; to get a concave rectangle or append upper</span>
<span class="sd">            case &#39;C&#39; to get a convex rectangle.</span>
<span class="sd">        fill : str</span>
<span class="sd">            Sets the shade or color used for filling the text box [Default is</span>
<span class="sd">            no fill].</span>
<span class="sd">        offset : str</span>
<span class="sd">            ``[j|J]dx[/dy][+v[pen]]``</span>
<span class="sd">            Offsets the text from the projected (x,y) point by dx,dy [0/0]. If</span>
<span class="sd">            dy is not specified then it is set equal to dx. Use offset=&#39;j&#39; to</span>
<span class="sd">            offset the text away from the point instead (i.e., the text</span>
<span class="sd">            justification will determine the direction of the shift). Using</span>
<span class="sd">            offset=&#39;J&#39; will shorten diagonal offsets at corners by sqrt(2).</span>
<span class="sd">            Optionally, append &#39;+v&#39; which will draw a line from the original</span>
<span class="sd">            point to the shifted point; append a pen to change the attributes</span>
<span class="sd">            for this line.</span>
<span class="sd">        pen : str</span>
<span class="sd">            Sets the pen used to draw a rectangle around the text string</span>
<span class="sd">            (see *clearance*) [Default is width = default, color = black,</span>
<span class="sd">            style = solid].</span>
<span class="sd">        no_clip : bool</span>
<span class="sd">            Do NOT clip text at map boundaries [Default is False, i.e. will</span>
<span class="sd">            clip].</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># pylint: disable=too-many-locals</span>
        <span class="c1"># pylint: disable=too-many-branches</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Ensure inputs are either textfiles, x/y/text, or position/text</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">textfiles</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span>
                    <span class="s2">&quot;Provide either position only, or x/y pairs, not both&quot;</span>
                <span class="p">)</span>
            <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;vectors&quot;</span>

        <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;vectors&quot;</span> <span class="ow">and</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Must provide text with x/y pairs or position&quot;</span><span class="p">)</span>

        <span class="c1"># Build the `-F` argument in gmt text.</span>
        <span class="k">if</span> <span class="s2">&quot;F&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="n">position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">or</span> <span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">or</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">or</span> <span class="n">justify</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">)</span>
        <span class="p">):</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;+a</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">font</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">font</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;+f</span><span class="si">{</span><span class="n">font</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">justify</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">justify</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;+j</span><span class="si">{</span><span class="n">justify</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;+c</span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s1">+t&quot;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&quot;&#39;</span>

        <span class="n">extra_arrays</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># If an array of transparency is given, GMT will read it from</span>
        <span class="c1"># the last numerical column per data record.</span>
        <span class="k">if</span> <span class="s2">&quot;t&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">is_nonstr_iter</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]):</span>
            <span class="n">extra_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">textfiles</span><span class="p">)</span> <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;vectors&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_vectors</span><span class="p">(</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                        <span class="o">*</span><span class="n">extra_arrays</span><span class="p">,</span>
                        <span class="c1"># text must be in str type, see issue #706</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span>
                    <span class="p">)</span>
            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>

    <span class="nd">@fmt_docstring</span>
    <span class="nd">@use_alias</span><span class="p">(</span>
        <span class="n">R</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
        <span class="n">J</span><span class="o">=</span><span class="s2">&quot;projection&quot;</span><span class="p">,</span>
        <span class="n">B</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span>
        <span class="n">N</span><span class="o">=</span><span class="s2">&quot;no_clip&quot;</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="s2">&quot;verbose&quot;</span><span class="p">,</span>
        <span class="n">X</span><span class="o">=</span><span class="s2">&quot;xshift&quot;</span><span class="p">,</span>
        <span class="n">Y</span><span class="o">=</span><span class="s2">&quot;yshift&quot;</span><span class="p">,</span>
        <span class="n">p</span><span class="o">=</span><span class="s2">&quot;perspective&quot;</span><span class="p">,</span>
        <span class="n">t</span><span class="o">=</span><span class="s2">&quot;transparency&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="nd">@kwargs_to_strings</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;sequence&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">meca</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">spec</span><span class="p">,</span>
        <span class="n">scale</span><span class="p">,</span>
        <span class="n">longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">convention</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">component</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span>
        <span class="n">plot_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">plot_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot focal mechanisms.</span>

<span class="sd">        Full option list at :gmt-docs:`supplements/seis/meca.html`</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">            Currently, labeling of beachballs with text strings is only</span>
<span class="sd">            supported via providing a file to `spec` as input.</span>

<span class="sd">        {aliases}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        spec: dict, 1D array, 2D array, pd.DataFrame, or str</span>
<span class="sd">            Either a filename containing focal mechanism parameters as columns,</span>
<span class="sd">            a 1- or 2-D array with the same, or a dictionary. If a filename or</span>
<span class="sd">            array, `convention` is required so we know how to interpret the</span>
<span class="sd">            columns/entries. If a dictionary, the following combinations of</span>
<span class="sd">            keys are supported; these determine the convention. Dictionary</span>
<span class="sd">            may contain values for a single focal mechanism or lists of</span>
<span class="sd">            values for many focal mechanisms. A Pandas DataFrame may</span>
<span class="sd">            optionally contain columns latitude, longitude, depth,</span>
<span class="sd">            plot_longitude,</span>
<span class="sd">            and/or plot_latitude instead of passing them to the meca method.</span>

<span class="sd">            - ``&quot;aki&quot;`` — *strike, dip, rake, magnitude*</span>
<span class="sd">            - ``&quot;gcmt&quot;`` — *strike1, dip1, rake1, strike2, dip2, rake2,</span>
<span class="sd">              mantissa, exponent*</span>
<span class="sd">            - ``&quot;mt&quot;`` — *mrr, mtt, mff, mrt, mrf, mtf, exponent*</span>
<span class="sd">            - ``&quot;partial&quot;`` — *strike1, dip1, strike2, fault_type, magnitude*</span>
<span class="sd">            - ``&quot;principal_axis&quot;`` — *t_exponent, t_azimuth, t_plunge,</span>
<span class="sd">              n_exponent, n_azimuth, n_plunge, p_exponent, p_azimuth, p_plunge,</span>
<span class="sd">              exponent*</span>

<span class="sd">        scale: str</span>
<span class="sd">            Adjusts the scaling of the radius of the beachball, which is</span>
<span class="sd">            proportional to the magnitude. Scale defines the size for</span>
<span class="sd">            magnitude = 5 (i.e. scalar seismic moment M0 = 4.0E23 dynes-cm)</span>
<span class="sd">        longitude: int, float, list, or 1d numpy array</span>
<span class="sd">            Longitude(s) of event location. Ignored if `spec` is not a</span>
<span class="sd">            dictionary. List must be the length of the number of events.</span>
<span class="sd">            Ignored if `spec` is a DataFrame and contains a &#39;longitude&#39; column.</span>
<span class="sd">        latitude: int, float, list, or 1d numpy array</span>
<span class="sd">            Latitude(s) of event location. Ignored if `spec` is not a</span>
<span class="sd">            dictionary. List must be the length of the number of events.</span>
<span class="sd">            Ignored if `spec` is a DataFrame and contains a &#39;latitude&#39; column.</span>
<span class="sd">        depth: int, float, list, or 1d numpy array</span>
<span class="sd">            Depth(s) of event location in kilometers. Ignored if `spec` is</span>
<span class="sd">            not a dictionary. List must be the length of the number of events.</span>
<span class="sd">            Ignored if `spec` is a DataFrame and contains a &#39;depth&#39; column.</span>
<span class="sd">        convention: str</span>
<span class="sd">            ``&quot;aki&quot;`` (Aki &amp; Richards), ``&quot;gcmt&quot;`` (global CMT), ``&quot;mt&quot;``</span>
<span class="sd">            (seismic moment tensor), ``&quot;partial&quot;`` (partial focal mechanism),</span>
<span class="sd">            or ``&quot;principal_axis&quot;`` (principal axis). Ignored if `spec` is a</span>
<span class="sd">            dictionary or dataframe.</span>
<span class="sd">        component: str</span>
<span class="sd">            The component of the seismic moment tensor to plot. ``&quot;full&quot;`` (the</span>
<span class="sd">            full seismic moment tensor), ``&quot;dc&quot;`` (the closest double couple</span>
<span class="sd">            with zero trace and zero determinant), ``&quot;deviatoric&quot;`` (zero</span>
<span class="sd">            trace)</span>
<span class="sd">        plot_longitude: int, float, list, or 1d numpy array</span>
<span class="sd">            Longitude(s) at which to place beachball, only used if `spec` is a</span>
<span class="sd">            dictionary. List must be the length of the number of events.</span>
<span class="sd">            Ignored if `spec` is a DataFrame and contains a &#39;plot_longitude&#39;</span>
<span class="sd">            column.</span>
<span class="sd">        plot_latitude: int, float, list, or 1d numpy array</span>
<span class="sd">            Latitude(s) at which to place beachball, only used if `spec` is a</span>
<span class="sd">            dictionary. List must be the length of the number of events.</span>
<span class="sd">            Ignored if `spec` is a DataFrame and contains a &#39;plot_latitude&#39;</span>
<span class="sd">            column.</span>
<span class="sd">        offset: bool or str</span>
<span class="sd">            Offsets beachballs to the longitude, latitude specified in</span>
<span class="sd">            the last two columns of the input file or array,</span>
<span class="sd">            or by `plot_longitude` and `plot_latitude` if provided. A small</span>
<span class="sd">            circle is plotted at the initial location and a line connects</span>
<span class="sd">            the beachball to the circle. Specify pen and optionally append</span>
<span class="sd">            ``+ssize`` to change the line style and/or size of the circle.</span>
<span class="sd">        no_clip : bool</span>
<span class="sd">            Does NOT skip symbols that fall outside frame boundary specified by</span>
<span class="sd">            *region* [Default is False, i.e. plot symbols inside map frame</span>
<span class="sd">            only].</span>
<span class="sd">        {J}</span>
<span class="sd">        {R}</span>
<span class="sd">        {B}</span>
<span class="sd">        {V}</span>
<span class="sd">        {XY}</span>
<span class="sd">        {p}</span>
<span class="sd">        {t}</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># pylint warnings that need to be fixed</span>
        <span class="c1"># pylint: disable=too-many-locals</span>
        <span class="c1"># pylint: disable=too-many-nested-blocks</span>
        <span class="c1"># pylint: disable=too-many-branches</span>
        <span class="c1"># pylint: disable=no-self-use</span>
        <span class="c1"># pylint: disable=too-many-statements</span>

        <span class="k">def</span> <span class="nf">set_pointer</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set optional parameter pointers based on DataFrame or dict, if</span>
<span class="sd">            those parameters are present in the DataFrame or dict.&quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_pointers</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                    <span class="c1"># set pointer based on param name</span>
                    <span class="n">data_pointers</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">update_pointers</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Updates variables based on the location of data, as the</span>
<span class="sd">            following data can be passed as parameters or it can be</span>
<span class="sd">            contained in `spec`.&quot;&quot;&quot;</span>
            <span class="c1"># update all pointers</span>
            <span class="n">longitude</span> <span class="o">=</span> <span class="n">data_pointers</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span>
            <span class="n">latitude</span> <span class="o">=</span> <span class="n">data_pointers</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span>
            <span class="n">depth</span> <span class="o">=</span> <span class="n">data_pointers</span><span class="p">[</span><span class="s2">&quot;depth&quot;</span><span class="p">]</span>
            <span class="n">plot_longitude</span> <span class="o">=</span> <span class="n">data_pointers</span><span class="p">[</span><span class="s2">&quot;plot_longitude&quot;</span><span class="p">]</span>
            <span class="n">plot_latitude</span> <span class="o">=</span> <span class="n">data_pointers</span><span class="p">[</span><span class="s2">&quot;plot_latitude&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">plot_longitude</span><span class="p">,</span> <span class="n">plot_latitude</span><span class="p">)</span>

        <span class="c1"># Check the spec and parse the data according to the specified</span>
        <span class="c1"># convention</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
            <span class="c1"># dicts and DataFrames are handed similarly but not identically</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">longitude</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">latitude</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">depth</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="n">GMTError</span><span class="p">(</span><span class="s2">&quot;Location not fully specified.&quot;</span><span class="p">)</span>

            <span class="n">param_conventions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;AKI&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;strike&quot;</span><span class="p">,</span> <span class="s2">&quot;dip&quot;</span><span class="p">,</span> <span class="s2">&quot;rake&quot;</span><span class="p">,</span> <span class="s2">&quot;magnitude&quot;</span><span class="p">],</span>
                <span class="s2">&quot;GCMT&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;strike1&quot;</span><span class="p">,</span> <span class="s2">&quot;dip1&quot;</span><span class="p">,</span> <span class="s2">&quot;dip2&quot;</span><span class="p">,</span> <span class="s2">&quot;rake2&quot;</span><span class="p">,</span> <span class="s2">&quot;mantissa&quot;</span><span class="p">,</span> <span class="s2">&quot;exponent&quot;</span><span class="p">],</span>
                <span class="s2">&quot;MT&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mrr&quot;</span><span class="p">,</span> <span class="s2">&quot;mtt&quot;</span><span class="p">,</span> <span class="s2">&quot;mff&quot;</span><span class="p">,</span> <span class="s2">&quot;mrt&quot;</span><span class="p">,</span> <span class="s2">&quot;mrf&quot;</span><span class="p">,</span> <span class="s2">&quot;mtf&quot;</span><span class="p">,</span> <span class="s2">&quot;exponent&quot;</span><span class="p">],</span>
                <span class="s2">&quot;PARTIAL&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;strike1&quot;</span><span class="p">,</span> <span class="s2">&quot;dip1&quot;</span><span class="p">,</span> <span class="s2">&quot;strike2&quot;</span><span class="p">,</span> <span class="s2">&quot;fault_type&quot;</span><span class="p">,</span> <span class="s2">&quot;magnitude&quot;</span><span class="p">],</span>
                <span class="s2">&quot;PRINCIPAL_AXIS&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;t_exponent&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;t_azimuth&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;t_plunge&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;n_exponent&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;n_azimuth&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;n_plunge&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;p_exponent&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;p_azimuth&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;p_plunge&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;exponent&quot;</span><span class="p">,</span>
                <span class="p">],</span>
            <span class="p">}</span>

            <span class="c1"># to keep track of where optional parameters exist</span>
            <span class="n">data_pointers</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="n">longitude</span><span class="p">,</span>
                <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">latitude</span><span class="p">,</span>
                <span class="s2">&quot;depth&quot;</span><span class="p">:</span> <span class="n">depth</span><span class="p">,</span>
                <span class="s2">&quot;plot_longitude&quot;</span><span class="p">:</span> <span class="n">plot_longitude</span><span class="p">,</span>
                <span class="s2">&quot;plot_latitude&quot;</span><span class="p">:</span> <span class="n">plot_latitude</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="c1"># make a DataFrame copy to check convention if it contains</span>
            <span class="c1"># other parameters</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
                <span class="c1"># check if a copy is necessary</span>
                <span class="n">copy</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">drop_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">pointer</span> <span class="ow">in</span> <span class="n">data_pointers</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">pointer</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">:</span>
                        <span class="n">copy</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">drop_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pointer</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">copy</span><span class="p">:</span>
                    <span class="n">spec_conv</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="c1"># delete optional parameters from copy for convention check</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">drop_list</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">spec_conv</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">spec_conv</span> <span class="o">=</span> <span class="n">spec</span>

            <span class="c1"># set convention and focal parameters based on spec convention</span>
            <span class="n">convention_assigned</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="n">param_conventions</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">spec_conv</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">param_conventions</span><span class="p">[</span><span class="n">conv</span><span class="p">]):</span>
                    <span class="n">convention</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="n">foc_params</span> <span class="o">=</span> <span class="n">param_conventions</span><span class="p">[</span><span class="n">conv</span><span class="p">]</span>
                    <span class="n">convention_assigned</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">convention_assigned</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTError</span><span class="p">(</span>
                    <span class="s2">&quot;Parameters in spec dictionary do not match known &quot;</span> <span class="s2">&quot;conventions.&quot;</span>
                <span class="p">)</span>

            <span class="c1"># create a dict type pointer for easier to read code</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">dict_type_pointer</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
                <span class="c1"># use df.values as pointer for DataFrame behavior</span>
                <span class="n">dict_type_pointer</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">values</span>

            <span class="c1"># assemble the 1D array for the case of floats and ints as values</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_type_pointer</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="c1"># update pointers</span>
                <span class="n">set_pointer</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
                <span class="c1"># look for optional parameters in the right place</span>
                <span class="p">(</span>
                    <span class="n">longitude</span><span class="p">,</span>
                    <span class="n">latitude</span><span class="p">,</span>
                    <span class="n">depth</span><span class="p">,</span>
                    <span class="n">plot_longitude</span><span class="p">,</span>
                    <span class="n">plot_latitude</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="n">update_pointers</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">)</span>

                <span class="c1"># Construct the array (order matters)</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="p">[</span><span class="n">longitude</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">depth</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">spec</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">foc_params</span><span class="p">]</span>

                <span class="c1"># Add in plotting options, if given, otherwise add 0s</span>
                <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">plot_longitude</span><span class="p">,</span> <span class="n">plot_latitude</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

            <span class="c1"># or assemble the 2D array for the case of lists as values</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_type_pointer</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="c1"># update pointers</span>
                <span class="n">set_pointer</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
                <span class="c1"># look for optional parameters in the right place</span>
                <span class="p">(</span>
                    <span class="n">longitude</span><span class="p">,</span>
                    <span class="n">latitude</span><span class="p">,</span>
                    <span class="n">depth</span><span class="p">,</span>
                    <span class="n">plot_longitude</span><span class="p">,</span>
                    <span class="n">plot_latitude</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="n">update_pointers</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">)</span>

                <span class="c1"># before constructing the 2D array lets check that each key</span>
                <span class="c1"># of the dict has the same quantity of values to avoid bugs</span>
                <span class="n">list_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">!=</span> <span class="n">list_length</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">GMTError</span><span class="p">(</span>
                            <span class="s2">&quot;Unequal number of focal mechanism &quot;</span>
                            <span class="s2">&quot;parameters supplied in &#39;spec&#39;.&quot;</span>
                        <span class="p">)</span>
                    <span class="c1"># lets also check the inputs for longitude, latitude,</span>
                    <span class="c1"># and depth if it is a list or array</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                    <span class="p">):</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">longitude</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">latitude</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span>
                            <span class="nb">len</span><span class="p">(</span><span class="n">longitude</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
                        <span class="p">):</span>
                            <span class="k">raise</span> <span class="n">GMTError</span><span class="p">(</span>
                                <span class="s2">&quot;Unequal number of focal mechanism &quot;</span>
                                <span class="s2">&quot;locations supplied.&quot;</span>
                            <span class="p">)</span>

                <span class="c1"># values are ok, so build the 2D array</span>
                <span class="n">spec_array</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">list_length</span><span class="p">):</span>
                    <span class="c1"># Construct the array one row at a time (note that order</span>
                    <span class="c1"># matters here, hence the list comprehension!)</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">longitude</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">latitude</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">depth</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span>
                        <span class="n">spec</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">foc_params</span>
                    <span class="p">]</span>

                    <span class="c1"># Add in plotting options, if given, otherwise add 0s as</span>
                    <span class="c1"># required by GMT</span>
                    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">plot_longitude</span><span class="p">,</span> <span class="n">plot_latitude</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                    <span class="n">spec_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">spec_array</span>

            <span class="c1"># or assemble the array for the case of pd.DataFrames</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_type_pointer</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="c1"># update pointers</span>
                <span class="n">set_pointer</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
                <span class="c1"># look for optional parameters in the right place</span>
                <span class="p">(</span>
                    <span class="n">longitude</span><span class="p">,</span>
                    <span class="n">latitude</span><span class="p">,</span>
                    <span class="n">depth</span><span class="p">,</span>
                    <span class="n">plot_longitude</span><span class="p">,</span>
                    <span class="n">plot_latitude</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">=</span> <span class="n">update_pointers</span><span class="p">(</span><span class="n">data_pointers</span><span class="p">)</span>

                <span class="c1"># lets also check the inputs for longitude, latitude, and depth</span>
                <span class="c1"># just in case the user entered different length lists</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="nb">isinstance</span><span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                    <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                    <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                <span class="p">):</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">longitude</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">latitude</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">longitude</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
                    <span class="p">):</span>
                        <span class="k">raise</span> <span class="n">GMTError</span><span class="p">(</span>
                            <span class="s2">&quot;Unequal number of focal mechanism locations supplied.&quot;</span>
                        <span class="p">)</span>

                <span class="c1"># values are ok, so build the 2D array in the correct order</span>
                <span class="n">spec_array</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="p">)):</span>
                    <span class="c1"># Construct the array one row at a time (note that order</span>
                    <span class="c1"># matters here, hence the list comprehension!)</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">longitude</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">latitude</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">depth</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span>
                        <span class="n">spec</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">foc_params</span>
                    <span class="p">]</span>

                    <span class="c1"># Add in plotting options, if given, otherwise add 0s as</span>
                    <span class="c1"># required by GMT</span>
                    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">plot_longitude</span><span class="p">,</span> <span class="n">plot_latitude</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="s2">&quot;C&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                    <span class="n">spec_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
                <span class="n">spec</span> <span class="o">=</span> <span class="n">spec_array</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTError</span><span class="p">(</span>
                    <span class="s2">&quot;Parameter &#39;spec&#39; contains values of an unsupported type.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Add condition and scale to kwargs</span>
        <span class="k">if</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;aki&quot;</span><span class="p">:</span>
            <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
        <span class="k">elif</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;gcmt&quot;</span><span class="p">:</span>
            <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span>
        <span class="k">elif</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;mt&quot;</span><span class="p">:</span>
            <span class="c1"># Check which component of mechanism the user wants plotted</span>
            <span class="k">if</span> <span class="n">component</span> <span class="o">==</span> <span class="s2">&quot;deviatoric&quot;</span><span class="p">:</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;z&quot;</span>
            <span class="k">elif</span> <span class="n">component</span> <span class="o">==</span> <span class="s2">&quot;dc&quot;</span><span class="p">:</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;d&quot;</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># component == &#39;full&#39;</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span>
        <span class="k">elif</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;partial&quot;</span><span class="p">:</span>
            <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;p&quot;</span>
        <span class="k">elif</span> <span class="n">convention</span> <span class="o">==</span> <span class="s2">&quot;principal_axis&quot;</span><span class="p">:</span>
            <span class="c1"># Check which component of mechanism the user wants plotted</span>
            <span class="k">if</span> <span class="n">component</span> <span class="o">==</span> <span class="s2">&quot;deviatoric&quot;</span><span class="p">:</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;t&quot;</span>
            <span class="k">elif</span> <span class="n">component</span> <span class="o">==</span> <span class="s2">&quot;dc&quot;</span><span class="p">:</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># component == &#39;full&#39;</span>
                <span class="n">data_format</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span>
        <span class="c1"># Support old-school GMT format options</span>
        <span class="k">elif</span> <span class="n">convention</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">]:</span>
            <span class="n">data_format</span> <span class="o">=</span> <span class="n">convention</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GMTError</span><span class="p">(</span><span class="s2">&quot;Convention not recognized.&quot;</span><span class="p">)</span>

        <span class="c1"># Assemble -S flag</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_format</span> <span class="o">+</span> <span class="n">scale</span>

        <span class="n">kind</span> <span class="o">=</span> <span class="n">data_kind</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">lib</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;matrix&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">virtualfile_from_matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">spec</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">file_context</span> <span class="o">=</span> <span class="n">dummy_context</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GMTInvalidInput</span><span class="p">(</span><span class="s2">&quot;Unrecognized data type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">spec</span><span class="p">)))</span>
            <span class="k">with</span> <span class="n">file_context</span> <span class="k">as</span> <span class="n">fname</span><span class="p">:</span>
                <span class="n">arg_str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">fname</span><span class="p">,</span> <span class="n">build_arg_string</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)])</span>
                <span class="n">lib</span><span class="o">.</span><span class="n">call_module</span><span class="p">(</span><span class="s2">&quot;meca&quot;</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          
<footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2020, The PyGMT Developers.
      
        <span class="commit">
          Revision <code><a href="https://github.com/GenericMappingTools/pygmt/commit/9aa3d36">9aa3d36</a></code>.
        </span>
      

    </p>
  </div>
<p>
Built with <a href="http://sphinx-doc.org/">Sphinx</a>
using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
provided by <a href="https://readthedocs.org">Read the Docs</a>
</p>
<p>
This website uses Google Analytics to gather usage statistics.
However, it does not use cookies or track you across different websites.
Page view data are used to help us improve the site and provide an estimate of the
software usage.
</p>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>